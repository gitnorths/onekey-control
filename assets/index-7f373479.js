import{m as g,b as le}from"./index-973d4a29.js";import{r as t,a as ae,o as oe,b as u,c as d,d as v,e as B,f as s,w as n,g as C,F as D,h as E,i as h,j as te,E as L,k as ne}from"./index-ab209780.js";const se={class:"oc-box"},ue={class:"oc-box__header"},de={class:"oc-box__main"},ce={key:1,class:"oc-empty"},ie={class:"dialog-footer"},re={key:0},_e={__name:"index",setup(pe){const y=t(null),k=t([]),N=t(null),R=t([]),M=t(null),w=t([]),x=t(null),_=t([]),p=t([]),f=t([]),T=t("模型导入"),m=t(!1),b=t(!1),j=ae({}),F=t(),I=t(le+"/uploadModel"),V=t([]),P=()=>{g("getStation").then(l=>{if(l.data.length>0){k.value=l.data.map(a=>({...a,label:a.name,value:a.oid}));const e=l.data[0];y.value=e.oid,U(e.name)}})},$=l=>{g("getBay",{oid:l}).then(e=>{e.data.length>0&&(w.value=e.data.map(a=>({...a,label:a.name,value:a.oid})))})},O=l=>{g("getSwitch",{oid:l}).then(e=>{e.data.length>0&&(_.value=e.data.map(a=>({...a,label:a.name,value:a.oid})))})},U=l=>{g("getModelInfo",{station:l}).then(e=>{if(f.value=[],p.value=[],!(e!=null&&e.data))return;const a=e.data[0][l],c=a[0];for(const i in c)if(Object.hasOwnProperty.call(c,i)){const r=c[i];f.value.push({prop:i,label:r})}a.shift(),p.value=a})},G=(l,e)=>{switch(l){case"station":if(N.value=null,M.value=null,x.value=null,e){const a=k.value.find(c=>c.oid===e);U(a.name)}else R.value=[],w.value=[],_.value=[],f.value=[],p.value=[];break;case"voltage":M.value=null,x.value=null,e?$(e):(w.value=[],_.value=[]);break;case"bay":x.value=null,e?O(e):_.value=[];break;case"device":e&&O(e);break}},q=()=>{m.value=!0},z=(l,e)=>{console.log(l,e)},A=l=>{console.log(l)},H=l=>{var e;console.log(l),l.code==0&&((e=l==null?void 0:l.data)!=null&&e.length)?(b.value=!1,m.value=!1,L({message:"上传成功！",type:"success"})):L.error(l.desc)},J=(l,e)=>ne.confirm(`确定删除已选择的文件 - ${l.name} ?`,{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then(()=>!0,()=>!1),K=()=>{b.value=!0,F.value.submit()};return oe(()=>{P()}),(l,e)=>{const a=u("el-option"),c=u("el-select"),i=u("el-form-item"),r=u("el-button"),S=u("el-form"),Q=u("el-table-column"),W=u("el-table"),X=u("el-empty"),Y=u("el-upload"),Z=u("el-dialog");return d(),v("div",se,[B("div",ue,[s(S,{inline:!0},{default:n(()=>[s(i,{label:"站所"},{default:n(()=>[s(c,{modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=o=>y.value=o),placeholder:"请选择",clearable:"",onChange:e[1]||(e[1]=o=>G("station",o))},{default:n(()=>[(d(!0),v(D,null,E(k.value,o=>(d(),C(a,{key:o.oid,label:o.name,value:o.oid},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(i,null,{default:n(()=>[s(r,{type:"primary",onClick:q},{default:n(()=>[h("模型导入")]),_:1})]),_:1})]),_:1})]),B("div",de,[p.value.length>0?(d(),C(W,{key:0,data:p.value,style:{width:"100%"}},{default:n(()=>[(d(!0),v(D,null,E(f.value,(o,ee)=>(d(),C(Q,{prop:o.prop,label:o.label,width:o.width?o.width:null,key:ee},null,8,["prop","label","width"]))),128))]),_:1},8,["data"])):(d(),v("div",ce,[s(X,{description:"暂无数据"})]))]),s(Z,{modelValue:m.value,"onUpdate:modelValue":e[4]||(e[4]=o=>m.value=o),title:T.value,"modal-class":"dialog-import"},{footer:n(()=>[B("span",ie,[s(r,{onClick:e[3]||(e[3]=o=>m.value=!1)},{default:n(()=>[h("取消")]),_:1}),s(r,{type:"primary",disabled:V.value.length==0,loading:b.value,onClick:K},{default:n(()=>[h(" 上传"),b.value?(d(),v("span",re,"中")):te("",!0)]),_:1},8,["disabled","loading"])])]),default:n(()=>[s(S,{model:j},{default:n(()=>[s(Y,{ref_key:"uploadRef",ref:F,"file-list":V.value,"onUpdate:fileList":e[2]||(e[2]=o=>V.value=o),class:"upload-demo",action:I.value,"auto-upload":!1,multiple:"",accept:"file",limit:1,"on-preview":A,"on-remove":z,"before-remove":J,"on-success":H},{tip:n(()=>[]),default:n(()=>[s(r,{type:"primary"},{default:n(()=>[h("选择上传文件")]),_:1})]),_:1},8,["file-list","action"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}};export{_e as default};

import{_ as L,m as I,b as W}from"./uploadModal-ba49a88f.js";import{_ as A,r as p,o as H,a as i,b as _,c as h,d as y,e as s,w as d,F as k,g as j,h as b,t as J,f as C}from"./index-72429201.js";const K={class:"oc-box device-state"},P={class:"oc-box__header"},Q={class:"oc-box__main"},X={class:"device-state__text"},Y={__name:"DeviceState",setup(Z){const m=p(null),w=p(null),x=p([]),M=p([{prop:"index",label:"序号",width:"100px"},{prop:"state",label:"状态"},{prop:"condition",label:"条件"},{prop:"parseResults",label:"解析结果"},{prop:"operator",label:"操作",width:"150px"}]),g=p([]),v=p(!1),$=p(null),S=p(null),V=p(null),B=()=>{I("getStation").then(a=>{if(a.data.length>0){x.value=a.data.map(l=>({...l,label:l.name,value:l.oid}));const e=a.data[0];m.value=e.oid,w.value=e.name,D(e.name)}})},D=a=>{I("getDevstatus",{station:a}).then(e=>{if(!(e!=null&&e.data))return;for(let u=0;u<e.data.length;u++){const c=e.data[u].status;for(let n=0;n<c.length;n++){const r=c[n];r.parseMap.forEach(o=>{g.value.push({index:r.sequence,state:r.status,condition:o.voltage+o.inteval+o.dev+o.jieci+o.status,parseResults:`${o.voltage}/${o.inteval}/${o.dev}/${o.jieci}/“/${o.status}/”"`})})}}const l=["index","state"];R(g.value,l)})},N=(a,e)=>{switch(a){case"station":{const l=x.value.find(u=>u.oid===e);w.value=l.name,D(l.name)}break}},U=()=>{v.value||(v.value=!v.value,$.value="设备态模型导入",S.value="550px",V.value=W+"/uploadOptabInfo")},z=()=>{v.value=!1};H(()=>{B()});const R=(a,e)=>{let l=[];e.forEach((u,c)=>{a.forEach(n=>{n.mergeCell=e;const r=`rowspan_${u}`;e.slice(0,c+1).every(o=>l[o]===n[o])?(n[r]=0,l[r]+=1):(n[r]=1,l=n)})})},T=({row:a,column:e,rowIndex:l,columnIndex:u})=>{if(a.mergeCell.includes(e.property)){const c=a[`rowspan_${e.property}`];return c?{rowspan:c,colspan:1}:{rowspan:0,colspan:0}}};return(a,e)=>{const l=i("el-option"),u=i("el-select"),c=i("el-form-item"),n=i("el-button"),r=i("el-form"),o=i("el-text"),O=i("dv-decoration-11"),E=i("el-table-column"),q=i("el-table");return _(),h("div",K,[y("div",P,[s(r,{inline:!0},{default:d(()=>[s(c,{label:"站所"},{default:d(()=>[s(u,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=t=>m.value=t),placeholder:"请选择",clearable:"",onChange:e[1]||(e[1]=t=>N("station",t))},{default:d(()=>[(_(!0),h(k,null,j(x.value,t=>(_(),C(l,{key:t.oid,label:t.name,value:t.oid},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(c,null,{default:d(()=>[s(n,{type:"primary",onClick:U},{default:d(()=>[b(" 设备态导入 ")]),_:1})]),_:1})]),_:1})]),y("div",Q,[y("div",X,[s(O,{style:{width:"500px",height:"60px"}},{default:d(()=>[s(o,{size:"large"},{default:d(()=>[b(J(w.value)+"-设备态解析结果",1)]),_:1})]),_:1})]),s(q,{data:g.value,"span-method":T,style:{width:"100%"}},{default:d(()=>[(_(!0),h(k,null,j(M.value,(t,F)=>(_(),h(k,{key:F},[t.prop!="operator"?(_(),C(E,{key:0,prop:t.prop,label:t.label,width:t.width?t.width:null},null,8,["prop","label","width"])):(_(),C(E,{key:1,prop:t.prop,label:t.label,width:t.width?t.width:null},{default:d(f=>[s(n,{type:"warning",size:"small",onClick:G=>a.handleEdit(f.$index,f.row)},{default:d(()=>[b(" 修正 ")]),_:2},1032,["onClick"]),s(n,{type:"success",size:"small",onClick:G=>a.handleEdit(f.$index,f.row)},{default:d(()=>[b(" 确认 ")]),_:2},1032,["onClick"])]),_:2},1032,["prop","label","width"]))],64))),128))]),_:1},8,["data"])]),s(L,{modelValue:v.value,"onUpdate:modelValue":e[2]||(e[2]=t=>v.value=t),title:$.value,width:S.value,url:V.value,onCancel:z},null,8,["modelValue","title","width","url"])])}}},ae=A(Y,[["__scopeId","data-v-6564048a"]]);export{ae as default};

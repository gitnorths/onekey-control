import{m}from"./index-706eafad.js";import{b as z}from"./axios-585fb22d.js";import{_ as A}from"./uploadModal-599deec7.js";import{r as t,o as H,c as f,a as D,b as s,w as r,d as w,e as n,f as c,F as S,g as U,h as J}from"./index-c88748e7.js";const K={class:"oc-box"},Q={class:"oc-box__header"},R={class:"oc-box__main"},X={key:1,class:"oc-empty"},te={__name:"index",setup(Y){const b=t(null),h=t([]),I=t(null),N=t([]),V=t(null),g=t([]),y=t(null),v=t([]),p=t([]),_=t([]),d=t(!1),x=t(null),C=t(null),B=t(null),j=()=>{m("getStation").then(o=>{if(o.data.length>0){h.value=o.data.map(l=>({...l,label:l.name,value:l.oid}));const e=o.data[0];b.value=e.oid,M(e.name)}})},F=o=>{m("getBay",{oid:o}).then(e=>{e.data.length>0&&(g.value=e.data.map(l=>({...l,label:l.name,value:l.oid})))})},O=o=>{m("getSwitch",{oid:o}).then(e=>{e.data.length>0&&(v.value=e.data.map(l=>({...l,label:l.name,value:l.oid})))})},M=o=>{m("getModelInfo",{station:o}).then(e=>{if(_.value=[],p.value=[],!(e!=null&&e.data))return;const l=e.data[0][o],u=l[0];for(const i in u)if(Object.hasOwnProperty.call(u,i)){const k=u[i];_.value.push({prop:i,label:k})}l.shift(),p.value=l})},T=(o,e)=>{switch(o){case"station":if(I.value=null,V.value=null,y.value=null,e){const l=h.value.find(u=>u.oid===e);M(l.name)}else N.value=[],g.value=[],v.value=[],_.value=[],p.value=[];break;case"voltage":V.value=null,y.value=null,e?F(e):(g.value=[],v.value=[]);break;case"bay":y.value=null,e?O(e):v.value=[];break;case"device":e&&O(e);break}},E=()=>{d.value||(d.value=!d.value,x.value="一次模型导入",C.value="600px",B.value=z+"/uploadModel")},G=()=>{d.value=!1};return H(()=>{j()}),(o,e)=>{const l=n("el-option"),u=n("el-select"),i=n("el-form-item"),k=n("el-button"),L=n("el-form"),P=n("el-table-column"),W=n("el-table"),$=n("el-empty");return c(),f("div",K,[D("div",Q,[s(L,{inline:!0},{default:r(()=>[s(i,{label:"站所"},{default:r(()=>[s(u,{modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=a=>b.value=a),placeholder:"请选择",clearable:"",onChange:e[1]||(e[1]=a=>T("station",a))},{default:r(()=>[(c(!0),f(S,null,U(h.value,a=>(c(),w(l,{key:a.oid,label:a.name,value:a.oid},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(i,null,{default:r(()=>[s(k,{type:"primary",onClick:E},{default:r(()=>[J("模型导入")]),_:1})]),_:1})]),_:1})]),D("div",R,[p.value.length>0?(c(),w(W,{key:0,data:p.value,style:{width:"100%"}},{default:r(()=>[(c(!0),f(S,null,U(_.value,(a,q)=>(c(),w(P,{prop:a.prop,label:a.label,width:a.width?a.width:null,key:q},null,8,["prop","label","width"]))),128))]),_:1},8,["data"])):(c(),f("div",X,[s($,{description:"暂无数据"})]))]),s(A,{modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=a=>d.value=a),title:x.value,width:C.value,url:B.value,onCancel:G},null,8,["modelValue","title","width","url"])])}}};export{te as default};
